<!DOCTYPE html>
<!-- saved from url=(0066)file:///C:/Users/j2-16/Downloads/interactive-newyear_Version3.html -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ä¸çŸ¥åç½‘ç«™</title>
  <meta name="description" content="äº¤äº’å¼æ–°å¹´é¡µé¢ï¼šå€’è®¡æ—¶ã€çƒŸèŠ±ã€å½©çº¸ã€ç¥ç¦å¢™ã€æœ¬åœ°ä¿å­˜ã€åˆ†äº«ä¸æµ·æŠ¥ç”Ÿæˆï¼ˆå•æ–‡ä»¶ HTMLï¼‰ã€‚">
  <style>
    /* ========= åŸºç¡€æ ·å¼ ========= */
    :root{
      --bg-top:#290707; --bg-bottom:#7a1212;
      --card: rgba(255,255,255,0.04);
      --accent: #ffd166;
      --muted: rgba(255,255,255,0.7);
      --maxw: 1100px;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family: "PingFang SC","Segoe UI","Helvetica Neue",Arial; background:linear-gradient(180deg,var(--bg-top),var(--bg-bottom)); color:#fff;-webkit-font-smoothing:antialiased}
    a{color:var(--accent)}

    /* canvas èƒŒæ™¯ï¼ˆçƒŸèŠ±/å½©ç‰‡ï¼‰ */
    canvas#fx{ position:fixed; inset:0; width:100%; height:100%; z-index:0; pointer-events:none; }

    /* å¸ƒå±€ */
    .wrap{ max-width:var(--maxw); margin:2rem auto; padding:0 1rem; position:relative; z-index:2 }
    header.site-header{ display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:1.2rem }
    .brand h1{ margin:0; font-size:1.5rem }
    .brand p{ margin:0; color:var(--muted); font-size:0.95rem }
    .controls{ display:flex; gap:.6rem; align-items:center }

    .countdown{ background:var(--glass); padding:.45rem .8rem; border-radius:8px; font-weight:700; min-width:220px; text-align:center }

    button.btn{ background:var(--accent); border:none; color:#0b0b0b; padding:.5rem .8rem; border-radius:8px; cursor:pointer; font-weight:700 }
    button.ghost{ background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted) }

    /* ç¯ç¬¼ï¼ˆå³ä¾§è£…é¥°ï¼‰ */
    .lanterns{ position:fixed; right:1rem; top:6rem; display:flex; flex-direction:column; gap:1rem; z-index:1; pointer-events:none }
    .lantern{ width:56px; height:86px; transform-origin:center; animation:sway 5s ease-in-out infinite }
    @keyframes sway{ 0%{transform:translateY(0) rotate(-2deg)} 50%{transform:translateY(6px) rotate(3deg)} 100%{transform:translateY(0) rotate(-2deg)} }

    /* å¡ç‰‡ */
    .card{ background:var(--card); padding:1rem; border-radius:12px; margin-bottom:1rem; box-shadow:0 10px 30px rgba(2,6,23,0.6) }
    .card h2{ margin-top:0 }
    .wall{ display:flex; flex-wrap:wrap; gap:.6rem; margin-top:.8rem }
    .wish{ background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:.7rem .9rem; border-radius:10px; min-width:180px; max-width:320px; box-shadow:0 8px 20px rgba(0,0,0,0.45) }
    .wish small{ display:block; color:var(--muted); margin-top:.5rem; font-size:.85rem }

    /* modal */
    .modal{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(2,6,23,0.5); z-index:10; visibility:hidden; opacity:0; transition:all .16s ease }
    .modal[aria-hidden="false"]{ visibility:visible; opacity:1 }
    .panel{ width:min(760px,94%); background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:1rem; border-radius:12px; box-shadow:0 12px 40px rgba(2,6,23,0.7) }
    textarea#wishInput{ width:100%; min-height:120px; padding:.8rem; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:transparent; color:#fff; resize:vertical }

    /* footer */
    footer{ text-align:center; padding:1.2rem 0; color:var(--muted); z-index:2; position:relative }

    /* small screens */
    @media (max-width:720px){
      .controls{ flex-direction:column; align-items:flex-end; gap:.45rem }
      .lanterns{ display:none }
      .countdown{ min-width:unset }
    }
  </style>
</head>
<body>
  <!-- ç”»å¸ƒï¼šçƒŸèŠ±ä¸å½©ç‰‡ -->
  <canvas id="fx" aria-hidden="true" width="1912" height="954"></canvas>

  <div class="wrap" role="main">
    <header class="site-header" role="banner">
      <div class="brand" aria-hidden="false">
        <h1>æ–°å¹´äº’åŠ¨ Â· ç¥ç¦å¢™ ğŸ‰</h1>
        <p>ç‚¹å‡»ä»»æ„å¤„è§¦å‘çƒŸèŠ±ã€‚æŠŠä½ çš„ç¥ç¦å†™ä¸‹ï¿½ï¿½å¹¶åˆ†äº«ç»™æœ‹å‹ï¼</p>
      </div>

      <div class="controls" role="toolbar" aria-label="é¡µé¢æ§åˆ¶">
        <div id="countdown" class="countdown" aria-live="polite">352 å¤© 08 : 43 : 28</div>
        <button id="openModal" class="btn" title="å†™ç¥ç¦">å†™ç¥ç¦</button>
        <button id="btnFire" class="btn" title="è§¦å‘çƒŸèŠ±ï¼ˆä¹Ÿå¯å•å‡»é¡µé¢ï¼‰">æ”¾çƒŸèŠ±</button>
        <button id="toggleMusic" class="btn ghost" title="æ’­æ”¾/æš‚åœèƒŒæ™¯éŸ³ä¹">æ’­æ”¾éŸ³ä¹</button>
      </div>
    </header>

    <section class="card" aria-labelledby="intro">
      <h2 id="intro">æ¬¢è¿</h2>
      <p>è¿™æ˜¯ä¸€ä¸ªå•æ–‡ä»¶ HTML çš„äº¤äº’å¼æ–°å¹´é¡µé¢ï¼šå€’è®¡æ—¶ã€çƒŸèŠ±ã€å½©ç‰‡ã€ç¥ç¦å¢™ï¼ˆä¿å­˜åœ¨æœ¬åœ°ï¼‰ã€åˆ†äº«ã€æµ·æŠ¥å¯¼å‡ºç­‰åŠŸèƒ½ã€‚é¡µé¢å®Œå…¨ç¦»çº¿å¯ç”¨ï¼ˆé™¤éä½ ä¸ºéŸ³ä¹æä¾›åœ¨çº¿èµ„æºï¼‰ã€‚</p>
    </section>

    <section class="card" aria-labelledby="wall">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h2 id="wall">ç¥ç¦å¢™</h2>
        <div>
          <button id="exportTxt" class="btn ghost">å¯¼å‡º (.txt)</button>
          <button id="clearWall" class="btn ghost">æ¸…ç©º</button>
        </div>
      </div>

      <div id="wallList" class="wall" aria-live="polite" aria-relevant="additions"><div class="wish"><div>ä¸‰ä¼ä¼ï¼æˆ‘çˆ±ä½ 1</div><small>2026/1/13 15:15:58</small></div><div class="wish"><div>æˆ‘è¦è·Ÿå¶èç»“å©š!</div><small>2026/1/13 15:14:24</small></div></div>
    </section>

    <section class="card" aria-labelledby="howto">
      <h2 id="howto">ä½¿ç”¨å°æç¤º</h2>
      <ol>
        <li>ç‚¹å‡»â€œå†™ç¥ç¦â€è¾“å…¥å¹¶å‘é€ï¼Œä¼šä¿å­˜åˆ°æœ¬åœ°ç¥ç¦å¢™ï¼ˆlocalStorageï¼‰ã€‚</li>
        <li>ç¥ç¦å¯é€šè¿‡ç³»ç»Ÿåˆ†äº«æˆ–å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œæˆ–ç”Ÿæˆ PNG æµ·æŠ¥ä¸‹è½½ã€‚</li>
        <li>ä»»æ„å¤„ç‚¹å‡»æˆ–æŒ‰ç©ºæ ¼/å›è½¦å¯è§¦å‘çƒŸèŠ±ï¼ˆé”®ç›˜å‹å¥½ï¼‰ã€‚</li>
      </ol>
    </section>
  </div>

  <footer role="contentinfo">
    <p>2026 æ–°å¹´äº’åŠ¨ Â· åˆ¶ä½œï¼šè‚–ç‘¾</p>
  </footer>

  <!-- å³ä¾§è£…é¥°ç¯ç¬¼ -->
  <div class="lanterns" aria-hidden="true">
    <svg class="lantern" viewBox="0 0 64 100" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="çº¢ç¯ç¬¼">
      <ellipse cx="32" cy="40" rx="26" ry="30" fill="#d33"></ellipse><rect x="26" y="6" width="12" height="12" rx="2" fill="#8b1d1d"></rect><rect x="30" y="70" width="4" height="20" rx="2" fill="#8b1d1d"></rect>
    </svg>
    <svg class="lantern" viewBox="0 0 64 100" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="é‡‘ç¯ç¬¼">
      <ellipse cx="32" cy="40" rx="26" ry="30" fill="#e64"></ellipse><rect x="26" y="6" width="12" height="12" rx="2" fill="#9b2a2a"></rect><rect x="30" y="70" width="4" height="20" rx="2" fill="#9b2a2a"></rect>
    </svg>
  </div>

  <!-- æ¨¡æ€å¼¹çª—ï¼šç¥ç¦è¾“å…¥ -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modalTitle">
    <div class="panel" role="document">
      <h3 id="modalTitle">å†™ä¸‹ä½ çš„æ–°å¹´ç¥ç¦</h3>
      <textarea id="wishInput" maxlength="300" placeholder="ä¾‹ï¼šç¥ä½ æ–°å¹´å¿«ä¹ï¼Œèº«ä½“å¥åº·ï¼Œå¿ƒæƒ³äº‹æˆï¼"></textarea>

      <div style="display:flex;gap:.6rem;margin-top:.7rem;flex-wrap:wrap">
        <button id="sendWish" class="btn">å‘é€å¹¶ä¿å­˜</button>
        <button id="shareWish" class="btn">ç³»ç»Ÿåˆ†äº« / å¤åˆ¶</button>
        <button id="downloadPoster" class="btn">ç”Ÿæˆå¹¶ä¸‹è½½æµ·æŠ¥</button>
        <button id="closeModal" class="btn ghost">å…³é—­</button>
      </div>
    </div>
  </div>

  <!-- å¯é€‰éŸ³ä¹ï¼ˆæ³¨é‡Š + å ä½ï¼‰ï¼Œå¦‚æœä½ æƒ³å¯ç”¨è¯·æŠŠ source æ³¨é‡Šå»æ‰æˆ–æ›¿æ¢ä¸ºæœ‰æ•ˆ URL -->
  <audio id="bgMusic" loop="" preload="metadata" aria-hidden="true">
    <!-- <source src="https://example.com/your-newyear-music.mp3" type="audio/mpeg"> -->
  </audio>

  <script>
    /* ========= äº¤äº’è„šæœ¬ï¼ˆå•æ–‡ä»¶ï¼‰ =========
       åŠŸèƒ½ï¼š
       - å€’è®¡æ—¶åˆ°ä¸‹ä¸€å¹´ï¼ˆè‡ªåŠ¨ï¼‰
       - ç‚¹å‡»/é”®ç›˜è§¦å‘çƒŸèŠ± + å½©ç‰‡ï¼ˆcanvasï¼‰
       - ç¥ç¦å¢™ï¼šlocalStorage ä¿å­˜ã€å¯¼å‡ºã€æ¸…ç©ºã€æ¸²æŸ“
       - æ¨¡æ€ï¼šå†™ç¥ç¦ã€åˆ†äº«ï¼ˆWeb Share æˆ– å‰ªè´´æ¿ï¼‰ã€ç”Ÿæˆæµ·æŠ¥ï¼ˆPNG å¹¶ä¸‹è½½ï¼‰
       - éŸ³ä¹å¼€å…³ï¼ˆéœ€æä¾›éŸ³é¢‘æºï¼‰
    */

    (function(){
      // å…ƒç´ 
      const canvas = document.getElementById('fx');
      const ctx = canvas.getContext('2d');
      const countEl = document.getElementById('countdown');
      const openModalBtn = document.getElementById('openModal');
      const modal = document.getElementById('modal');
      const closeModalBtn = document.getElementById('closeModal');
      const sendWishBtn = document.getElementById('sendWish');
      const shareWishBtn = document.getElementById('shareWish');
      const downloadPosterBtn = document.getElementById('downloadPoster');
      const wishInput = document.getElementById('wishInput');
      const wallList = document.getElementById('wallList');
      const clearWallBtn = document.getElementById('clearWall');
      const exportTxtBtn = document.getElementById('exportTxt');
      const btnFire = document.getElementById('btnFire');
      const musicBtn = document.getElementById('toggleMusic');
      const bgMusic = document.getElementById('bgMusic');

      // ç”»å¸ƒå°ºå¯¸
      let W = canvas.width = innerWidth;
      let H = canvas.height = innerHeight;
      function resize(){ W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
      addEventListener('resize', resize);

      // å€’è®¡æ—¶åˆ°ä¸‹ä¸€ä¸ªå…¬å†å¹´ 1 æœˆ 1 æ—¥ 00:00
      function getTarget(){
        const now = new Date();
        return new Date(now.getFullYear() + 1, 0, 1, 0, 0, 0);
      }
      const target = getTarget();
      function updateCountdown(){
        const now = new Date();
        let diff = Math.max(0, target - now);
        const days = Math.floor(diff / (1000*60*60*24));
        diff -= days * (1000*60*60*24);
        const hours = Math.floor(diff / (1000*60*60));
        diff -= hours * (1000*60*60);
        const minutes = Math.floor(diff / (1000*60));
        diff -= minutes * (1000*60);
        const seconds = Math.floor(diff / 1000);
        countEl.textContent = `${days} å¤© ${String(hours).padStart(2,'0')} : ${String(minutes).padStart(2,'0')} : ${String(seconds).padStart(2,'0')}`;
      }
      setInterval(updateCountdown, 1000);
      updateCountdown();

      /* ========== ç²’å­ç³»ç»Ÿï¼ˆçƒŸèŠ± + å½©ç‰‡ï¼‰ ========== */
      const particles = [];
      const confetti = [];
      const palette = ['#ff5c7a','#ffd166','#6ee7b7','#8cc0ff','#ff9bd6','#ffd8a8','#ffb347'];

      class P {
        constructor(x,y,vx,vy,color,size,shape='circle',life=120){
          this.x=x; this.y=y; this.vx=vx; this.vy=vy; this.color=color; this.size=size; this.shape=shape; this.life=life; this.alpha=1;
        }
        update(dt){
          this.vy += (this.shape==='confetti' ? 0.04 : 0.03) * dt;
          this.x += this.vx * dt;
          this.y += this.vy * dt;
          this.alpha -= 0.008 * dt;
          this.life -= dt;
        }
        draw(ctx){
          ctx.save();
          ctx.globalAlpha = Math.max(0, this.alpha);
          ctx.fillStyle = this.color;
          if(this.shape === 'rect'){
            ctx.fillRect(this.x, this.y, this.size*1.8, this.size*1.2);
          } else if(this.shape === 'confetti'){
            ctx.translate(this.x, this.y);
            ctx.rotate(Math.sin(this.life/8) * 1.2);
            ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size*0.6);
          } else {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
            ctx.fill();
          }
          ctx.restore();
        }
      }

      function spawnFire(x,y,strength=1.4){
        const count = Math.floor(28 * strength + Math.random()*36);
        const mainColor = palette[Math.floor(Math.random()*palette.length)];
        for(let i=0;i<count;i++){
          const angle = Math.random()*Math.PI*2;
          const speed = (Math.random()*3 + 1.6) * (0.6 + Math.random()*strength);
          const vx = Math.cos(angle)*speed;
          const vy = Math.sin(angle)*speed*0.9;
          particles.push(new P(x,y,vx,vy, mainColor, Math.random()*2.8+1.2, 'circle', Math.random()*80+60));
          if(Math.random() < 0.35) particles.push(new P(x,y,vx*0.6,vy*0.6, mainColor, Math.random()*3+2.2, 'rect', Math.random()*80+50));
        }
        // confetti burst
        for(let k=0;k<14;k++){
          const a = Math.random()*Math.PI*2;
          confetti.push(new P(x,y, Math.cos(a)* (Math.random()*2+0.8), Math.sin(a)*(Math.random()*2+0.8), palette[Math.floor(Math.random()*palette.length)], Math.random()*8+6, 'confetti', Math.random()*160+80));
        }
      }

      // ç‚¹å‡»æˆ–æŒ‰é’®è§¦å‘
      addEventListener('pointerdown', (e)=>{
        spawnFire(e.clientX, e.clientY, 1.2);
      });
      document.getElementById('btnFire').addEventListener('click', ()=>{
        spawnFire(innerWidth*0.5, innerHeight*0.4, 1.8);
      });

      // é”®ç›˜å‹å¥½ï¼š ç©ºæ ¼/å›è½¦ è§¦å‘ï¼ˆå½“ä¸åœ¨è¾“å…¥æ¡†æ—¶ï¼‰
      addEventListener('keydown', (e)=>{
        if(e.key === ' ' || e.key === 'Enter'){
          if(document.activeElement && (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA')) return;
          e.preventDefault();
          spawnFire(innerWidth*0.5, innerHeight*0.45, 1.2);
        }
        if(e.key === 'Escape') hideModal();
      });

      // åŠ¨ç”»å¾ªç¯
      let last = performance.now();
      function loop(now){
        const dt = Math.min(1.8, (now - last)/16);
        last = now;
        ctx.clearRect(0,0,W,H);
        // èƒŒæ™¯æ·¡å…‰
        const g = ctx.createLinearGradient(0,0,0,H);
        g.addColorStop(0, 'rgba(255,255,255,0.02)');
        g.addColorStop(1, 'rgba(0,0,0,0)');
        ctx.fillStyle = g;
        ctx.fillRect(0,0,W,H);

        for(let i = particles.length-1; i>=0; i--){
          const p = particles[i];
          p.update(dt);
          p.draw(ctx);
          if(p.life <= 0 || p.alpha <= 0 || p.y > H + 80) particles.splice(i,1);
        }
        for(let i = confetti.length-1; i>=0; i--){
          const p = confetti[i];
          p.update(dt);
          p.draw(ctx);
          if(p.life <= 0 || p.y > H + 120) confetti.splice(i,1);
        }
        requestAnimationFrame(loop);
      }
      requestAnimationFrame(loop);

      /* ========== ç¥ç¦å¢™ï¼ˆlocalStorageï¼‰ ========== */
      const KEY = 'interactive-newyear-wishes-v1';

      function load(){
        try{
          const raw = localStorage.getItem(KEY);
          return raw ? JSON.parse(raw) : [];
        }catch(e){ return []; }
      }
      function save(arr){
        try{ localStorage.setItem(KEY, JSON.stringify(arr)); }catch(e){}
      }
      function render(){
        const arr = load();
        wallList.innerHTML = '';
        if(arr.length === 0){
          wallList.innerHTML = '<div class="wish">å¿«å†™ä¸‹ä½ çš„ç¬¬ä¸€æ¡ç¥ç¦å§ï¼</div>';
          return;
        }
        arr.slice().reverse().forEach(item=>{
          const d = document.createElement('div');
          d.className = 'wish';
          d.innerHTML = `<div>${escapeHtml(item.text)}</div><small>${escapeHtml(item.time)}</small>`;
          wallList.appendChild(d);
        });
      }
      function addWish(text){
        if(!text || !text.trim()) return;
        const arr = load();
        arr.push({ text: text.trim(), time: new Date().toLocaleString() });
        save(arr);
        render();
      }
      function clearAll(){
        localStorage.removeItem(KEY);
        render();
      }
      function exportTxt(){
        const arr = load();
        if(!arr.length){ alert('ç¥ç¦å¢™ä¸ºç©ºï¼Œæ— æ³•å¯¼å‡º'); return; }
        const content = arr.map(i => `${i.time}\n${i.text}\n\n`).join('');
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'wishes.txt'; a.click();
        URL.revokeObjectURL(url);
      }
      function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

      // åˆå§‹åŒ–æ¸²æŸ“
      render();

      /* ========== æ¨¡æ€ä¸åˆ†äº« ========== */
      function showModal(){ modal.setAttribute('aria-hidden','false'); wishInput.value=''; wishInput.focus(); }
      function hideModal(){ modal.setAttribute('aria-hidden','true'); }

      openModalBtn.addEventListener('click', showModal);
      closeModalBtn.addEventListener('click', hideModal);
      modal.addEventListener('click', (e)=>{ if(e.target === modal) hideModal(); });

      // ä¿å­˜å¹¶å°åº†ç¥
      sendWishBtn.addEventListener('click', ()=>{
        const t = wishInput.value || '';
        if(!t.trim()){ alert('è¯·è¾“å…¥ç¥ç¦å†…å®¹'); return; }
        addWish(t);
        hideModal();
        spawnFire(innerWidth*0.5, innerHeight*0.35, 1.6);
      });

      // ç³»ç»Ÿåˆ†äº«æˆ–å‰ªè´´æ¿
      shareWishBtn.addEventListener('click', async ()=>{
        const t = wishInput.value || '';
        if(!t.trim()){ alert('è¯·è¾“å…¥ç¥ç¦å†…å®¹'); return; }
        try{
          if(navigator.share){
            await navigator.share({ title:'æ–°å¹´ç¥ç¦', text: t });
          } else if(navigator.clipboard){
            await navigator.clipboard.writeText(t);
            alert('ç¥ç¦å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¯ç²˜è´´åˆ†äº«');
          } else {
            alert('å½“å‰ç¯å¢ƒä¸æ”¯æŒç³»ç»Ÿåˆ†äº«æˆ–å‰ªè´´æ¿ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶æ–‡æœ¬');
          }
        }catch(e){
          alert('åˆ†äº«å¤±è´¥ï¼š'+ (e && e.message ? e.message : 'æœªçŸ¥é”™è¯¯'));
        }
      });

      /* ========== æµ·æŠ¥ç”Ÿæˆå¹¶ä¸‹è½½ï¼ˆcanvasï¼‰ ========== */
      downloadPosterBtn.addEventListener('click', ()=>{
        const t = wishInput.value || 'æ–°å¹´å¿«ä¹ï¼';
        genPoster(t);
      });

      function genPoster(text){
        const c = document.createElement('canvas');
        c.width = 1200; c.height = 1600;
        const cx = c.getContext('2d');

        // èƒŒæ™¯
        const g = cx.createLinearGradient(0,0,c.width,c.height);
        g.addColorStop(0, '#2b0b0b'); g.addColorStop(1, '#7b0a0a');
        cx.fillStyle = g; cx.fillRect(0,0,c.width,c.height);

        // è£…é¥°åœ†
        cx.beginPath(); cx.fillStyle = 'rgba(255,215,100,0.06)'; cx.arc(c.width/2, 380, 260, 0, Math.PI*2); cx.fill();

        // æ ‡é¢˜
        cx.fillStyle = '#ffd386'; cx.textAlign = 'center';
        cx.font = 'bold 64px sans-serif'; cx.fillText('æ–°å¹´å¿«ä¹ Â· 2026', c.width/2, 120);

        // ç¥ç¦æ–‡æœ¬ï¼ˆæ¢è¡Œï¼‰
        cx.fillStyle = '#fff2d6'; cx.font = '48px sans-serif';
        wrapText(cx, text, c.width/2, 540, 920, 64);

        // åº•éƒ¨
        cx.fillStyle = 'rgba(255,255,255,0.75)'; cx.font = '24px sans-serif';
        cx.fillText('æ¥è‡ª æ–°å¹´ç¥ç¦å¢™', c.width/2, c.height - 80);

        // ä¸‹è½½
        const a = document.createElement('a');
        a.download = 'newyear-wish.png';
        a.href = c.toDataURL('image/png');
        a.click();
      }
      function wrapText(ctx, text, x, y, maxWidth, lineHeight){
        const words = text.split(/\s+/);
        let line = '';
        let curY = y;
        for(let n=0;n<words.length;n++){
          const test = line ? (line + ' ' + words[n]) : words[n];
          if(ctx.measureText(test).width > maxWidth && n > 0){
            ctx.fillText(line, x, curY);
            line = words[n];
            curY += lineHeight;
          } else {
            line = test;
          }
        }
        ctx.fillText(line, x, curY);
      }

      /* ========== ç¥ç¦å¢™æŒ‰é’® ========= */
      clearWallBtn.addEventListener('click', ()=>{
        if(!confirm('ç¡®å®šæ¸…ç©ºæœ¬åœ°ä¿å­˜çš„æ‰€æœ‰ç¥ç¦å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) return;
        clearAll();
      });
      exportTxtBtn.addEventListener('click', exportTxt);


      // å°å½©è›‹ï¼šé¦–æ¬¡æ‰“å¼€ç»™ä¸€ç‚¹çƒŸèŠ±
      setTimeout(()=> spawnFire(innerWidth*0.5, innerHeight*0.4, 1.3), 900);

      // expose for console debugging (optional)
      window._NY = { spawnFire, addWish, render };

    })();
  </script>

</body></html>